!function(e){e.fn.searchHighlight=function(t){var n=e.extend(!0,{},{listSelector:"",searchFields:["text"],caseSensitive:!1,delay:0,highlightClass:"search-highlight",tokenized:!1,onSearchStart:null,onSearchComplete:null},t),a=this,i=e(n.listSelector);i.each((function(){var t=e(this);t.data("originalHTML")||t.data("originalHTML",t.html())}));var o,r,l;return a.on("input search",(o=function(){var t=a.val();if(!t)return i.each((function(){var t=e(this);t.html(t.data("originalHTML")),n.animation&&n.animation.show?t.stop(!0,!0)[n.animation.show](n.animation.duration):t.show()})),void("function"==typeof n.onSearchComplete&&n.onSearchComplete([]));"function"==typeof n.onSearchStart&&n.onSearchStart(t);var o=n.caseSensitive?"g":"gi",r=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),l=new RegExp(r,o),h=[];i.each((function(){var a=e(this),i=a.data("originalHTML"),r=!1,c=i;e.each(n.searchFields,(function(h,s){if("text"===s){var d=a.text();if(l.test(d)){r=!0,l.lastIndex=0;var f=e("<div>").html(i),m=function(e){if(3===e.nodeType){var t=e.nodeValue;if(l.test(t)){l.lastIndex=0;var a=document.createElement("span");a.className=n.highlightClass,a.textContent=t.match(l)[0];var i=t.split(l);if(e.nodeValue=i[0],e.parentNode.insertBefore(a,e.nextSibling),i[1]){var o=document.createTextNode(i[1]);e.parentNode.insertBefore(o,a.nextSibling)}}}else 1===e.nodeType&&Array.from(e.childNodes).forEach(m)};Array.from(f[0].childNodes).forEach(m),c=f.html()}else n.tokenized&&(p=t.split(/\s+/).filter((function(e){return e.length>0}))).every((function(e){return new RegExp(e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),o).test(d)}))&&p.length&&(r=!0,f=e("<div>").html(i),p.forEach((function(e){var t=e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),a=new RegExp(t,o),i=function(e){if(3===e.nodeType){var t=e.nodeValue;if(a.test(t)){a.lastIndex=0;for(var o=t.split(a),r=document.createDocumentFragment(),l=0;l<o.length;l++)if(r.appendChild(document.createTextNode(o[l])),l<o.length-1){var h=document.createElement("span");h.className=n.highlightClass,h.textContent=t.match(a)[0],r.appendChild(h)}e.parentNode.replaceChild(r,e)}}else 1===e.nodeType&&Array.from(e.childNodes).forEach(i)};Array.from(f[0].childNodes).forEach(i)})),c=f.html())}else if(0===s.indexOf("data-")){var u=a.attr(s)||"";if(l.test(u))r=!0;else if(n.tokenized){var p;(p=t.split(/\s+/).filter((function(e){return e.length>0}))).every((function(e){return new RegExp(e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),o).test(u)}))&&p.length&&(r=!0)}}})),r?(h.push(a),n.animation&&n.animation.show?a.stop(!0,!0)[n.animation.show](n.animation.duration):a.show(),a.html(c)):(n.animation&&n.animation.hide?a.stop(!0,!0)[n.animation.hide](n.animation.duration):a.hide(),a.html(i))})),"function"==typeof n.onSearchComplete&&n.onSearchComplete(h)},r=n.delay,function(){var e=this,t=arguments;clearTimeout(l),l=setTimeout((function(){o.apply(e,t)}),r)})),this}}(jQuery);